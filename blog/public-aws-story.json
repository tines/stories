{"schema_version":3,"name":"Public AWS Story","description":null,"guid":"94b54ecd737de37bc88523dda477ae31","exported_at":"2020-11-12T22:27:44Z","agents":[{"type":"Agents::HTTPRequestAgent","name":"Apply AWS S3 Bucket Block Policy","disabled":false,"guid":"b4acf9b75bc2ad1d6afdb76d6411bfc7","options":{"url":"https://{{.expand_event.message.detail.resource.s3BucketDetails.first.name}}.s3.{{.expand_event.message.detail.region}}.amazonaws.com/?publicAccessBlock","method":"put","content_type":"application/xml","headers":{"Authorization":"{{ .CREDENTIAL.aws_us_west_2_s3 }}"},"payload":"<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<PublicAccessBlockConfiguration>\n      <BlockPublicAcls>TRUE</BlockPublicAcls>\n      <IgnorePublicAcls>TRUE</IgnorePublicAcls>\n      <BlockPublicPolicy>TRUE</BlockPublicPolicy>\n      <RestrictPublicBuckets>TRUE</RestrictPublicBuckets>\n</PublicAccessBlockConfiguration>"},"schedule":null,"keep_events_for":0},{"type":"Agents::EventTransformationAgent","name":"Expand Event","disabled":false,"guid":"6f3e57740fbc15fe57032b8402051b6b","options":{"mode":"message_only","payload":{"message":"{{ .receive_sns.body.Message | as_object | parse_json }}"}},"keep_events_for":0},{"type":"Agents::TriggerAgent","name":"Is BucketAnonymousAccessGranted","disabled":false,"guid":"e87656f423e1ed5aa0e7e6ab05e082ba","options":{"rules":[{"type":"field==value","value":"Policy:S3/BucketAnonymousAccessGranted","path":"{{ .expand_event.message.detail.type }}"}]},"keep_events_for":0},{"type":"Agents::WebhookAgent","name":"Receive SNS","disabled":false,"guid":"cdf258f027567923a3fb6452ab4a1571","options":{"secret":"f8370380b1375defcbba96917477ca01","verbs":"get,post"},"keep_events_for":0}],"links":[{"source":1,"receiver":2},{"source":2,"receiver":0},{"source":3,"receiver":1}],"diagram_layout":"{\"cdf258f027567923a3fb6452ab4a1571\":[225,225],\"e87656f423e1ed5aa0e7e6ab05e082ba\":[225,405],\"6f3e57740fbc15fe57032b8402051b6b\":[225,315],\"b4acf9b75bc2ad1d6afdb76d6411bfc7\":[225,510]}","send_to_story_enabled":false,"entry_agent_guid":null,"exit_agent_guid":null,"send_to_stories":[],"form":{"name":"New story thomas@tines.io Form","description":"","fields":[],"visibility":"tenant","agent_guid":null,"enabled":false,"success_message":"Thank you for your submission"}}