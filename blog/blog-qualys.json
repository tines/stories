{"schema_version":3,"name":"Blog Qualys","description":"Melissa's Qualys\nFastScan 1181621\nFullScan 1181652","guid":"d3b8d425e6ec94357ee70237275e3063","exported_at":"2020-10-01T11:36:44Z","agents":[{"type":"Agents::HTTPRequestAgent","name":"Launch Report in Qualys","disabled":false,"guid":"eee391b7f123509604003f3410f6baab","options":{"url":"https://{% global_resource qualys %}/api/2.0/fo/report/","method":"post","payload":{"action":"launch","template_id":"1781809","output_format":"pdf","report_title":"{{ .get_scan_reference.scan_name }}","report_type":"Scan","ips":"{{ .receive_form_request.body.ip_address_or_multiple_addresses}}","report_refs":"{{ .get_scan_reference.scan_ref }}"},"basic_auth":["{% global_resource qualys_username %}","{% credential qualys_password %}"],"headers":{"X-Requested-With":"Tines","User-Agent":"Tines"}},"schedule":null,"keep_events_for":0},{"type":"Agents::HTTPRequestAgent","name":"Get Report From Qualys","disabled":false,"guid":"7d04c1cd4017cec66413145a427ba009","options":{"url":"https://{% global_resource qualys %}/api/2.0/fo/report/","method":"post","payload":{"action":"fetch","id":"{{ .launch_report_in_qualys.body.SIMPLE_RETURN.RESPONSE.ITEM_LIST.ITEM.VALUE}}"},"basic_auth":["{% global_resource qualys_username %}","{% credential qualys_password %}"],"headers":{"X-Requested-With":"Tines","User-Agent":"Tines"}},"schedule":null,"keep_events_for":0},{"type":"Agents::WebhookAgent","name":"Receive Form Request","disabled":false,"guid":"b2f5f9309bc460449a165a93df0e9e06","options":{"secret":"393766063798fb2bc8b3b99efe0f2ea3","verbs":"get,post"},"keep_events_for":0},{"type":"Agents::SendToStoryAgent","name":"Update Jira Case with Latest Information","disabled":false,"guid":"6e466cc2684c24356b9fd54e19008c59","options":{"story":"{% story STS Update Jira %}","payload":{"key":"value","something":"the event contained {{ .somekey }}"},"send_payload_as_body":"false"},"schedule":null,"keep_events_for":0},{"type":"Agents::TriggerAgent","name":"Loop If Not Complete","disabled":false,"guid":"f794e2da5764832644ab6dbc8335eb5a","options":{"rules":[{"type":"regex","value":"Unable.*","path":"{{ .fetch_scan_from_qualys.body.SIMPLE_RETURN.RESPONSE.TEXT}}"}]},"keep_events_for":0},{"type":"Agents::TriggerAgent","name":"Continue If Complete","disabled":false,"guid":"3727a6d978fa4a66acff969661f4da41","options":{"rules":[{"type":"field>value","value":"1","path":"{{ .fetch_scan_from_qualys.body.size}}"}]},"keep_events_for":0},{"type":"Agents::EventTransformationAgent","name":"Temp Delay For Processing","disabled":false,"guid":"851a703e6f307ad7faf50a7d7d2c4d29","options":{"mode":"delay","seconds":45},"keep_events_for":0},{"type":"Agents::EventTransformationAgent","name":"Delay Event","disabled":false,"guid":"5045ec75742882c8efbd958a537aab9a","options":{"mode":"delay","seconds":90},"keep_events_for":0},{"type":"Agents::EventTransformationAgent","name":"Delay Event","disabled":false,"guid":"5abf875016bf40171cf2dcd670a592b5","options":{"mode":"delay","seconds":30},"keep_events_for":0},{"type":"Agents::TriggerAgent","name":"Loop If Not Complete","disabled":false,"guid":"4502433a21f872e91b1d5eb1743f1f6f","options":{"rules":[{"type":"regex","value":"Report cannot be fetched.","path":"{{ .get_report_from_qualys.body.SIMPLE_RETURN.RESPONSE.TEXT }}"}]},"keep_events_for":0},{"type":"Agents::TriggerAgent","name":"Continue If Complete","disabled":false,"guid":"2297441afb7180f22a6df284d7bcdb79","options":{"rules":[{"type":"field>value","value":"1","path":"{{ .get_report_from_qualys.body.size}}"}]},"keep_events_for":0},{"type":"Agents::TriggerAgent","name":"No Live Hosts Found","disabled":false,"guid":"4b4a243277aed38a6865e6aa812dcee7","options":{"rules":[{"type":"field==value","value":"0","path":"{{ .fetch_scan_from_qualys.body.size}}"}]},"keep_events_for":0},{"type":"Agents::EventTransformationAgent","name":"Get Scan Reference","disabled":false,"guid":"fa9d0097c76f978cac1ba1f20a5e987d","options":{"mode":"message_only","scan_ref":"{{.launch_scan_in_qualys.body.SIMPLE_RETURN.RESPONSE.ITEM_LIST.ITEM | where: \"KEY\", \"REFERENCE\" | get: \"VALUE\" }}","scan_name":"Self Scan for {{ .receive_form_request.body.wbs_code }} at {{ \"now\" | date: \"%Y-%m-%d %H:%M\" }} UTC"},"keep_events_for":0},{"type":"Agents::EmailAgent","name":"Email Requester About Problem Scanning Host(s)","disabled":false,"guid":"a4703cebada7d89adc818ed8e67f4d20","options":{"recipients":"{{ .receive_form_request.body.requester_email}}","subject":"Security Self-Serve: Security Gating : Problem","body":"We could not find any live hosts to scan, please try again with your submission and doublecheck your IP range. "},"keep_events_for":0},{"type":"Agents::HTTPRequestAgent","name":"Add IPs to Qualys","disabled":false,"guid":"bcbe3e2321d94df8ce0e53ed99a78e84","options":{"url":"https://{% global_resource qualys %}/api/2.0/fo/asset/ip/","method":"post","payload":{"action":"add","ips":"{{ .receive_form_request.body.ip_address_or_multiple_addresses}}","enable_vm":"1","ud1":"Email: {{ .receive_form_request.body.requester_email}}, Code/Note: {{ .receive_form_request.body.project_wbs_code_or_note}}"},"basic_auth":["{% global_resource qualys_username %}","{% credential qualys_password %}"],"headers":{"X-Requested-With":"Tines"}},"schedule":null,"keep_events_for":0},{"type":"Agents::EmailAgent","name":"Email Requester With Report","disabled":false,"guid":"85168d4d6e7d52e9afa8a55d41b5e936","options":{"recipients":"{{ .receive_form_request.body.requester_email}}","subject":"Security Self-Serve: Security Gating : Report : {{ .get_scan_reference.scan_name }}","body":"Please find attached your requested security scan report. Please work with your product and engineering teams to remove all vulnerabilities or contact the security team for further information regarding any challenges in doing so. ","attachments":[{"filename":"{{ .get_scan_reference.scan_name }}","content_type":"{{ .get_report_from_qualys.body.content_type }}","base64encodedcontents":"{{ .get_report_from_qualys.body.base64encodedcontents}}"}]},"keep_events_for":0},{"type":"Agents::HTTPRequestAgent","name":"Launch Scan in Qualys","disabled":false,"guid":"3a7edabe067d153141219d0f1fe082e5","options":{"url":"https://{% global_resource qualys %}/api/2.0/fo/scan/","method":"post","payload":{"action":"launch","scan_title":"Self Scan for {{ .receive_form_request.body.wbs_code }} at {{ \"now\" | date: \"%Y-%m-%d %H:%M\" }} UTC","ip":"{{ .receive_form_request.body.ip_address_or_multiple_addresses}}","option_id":"1181652","priority":"1"},"basic_auth":["{% global_resource qualys_username %}","{% credential qualys_password %}"],"headers":{"X-Requested-With":"Tines"}},"schedule":null,"keep_events_for":0},{"type":"Agents::HTTPRequestAgent","name":"Fetch Scan from Qualys","disabled":false,"guid":"43f342bc42c38a0d41c8ec80a3471302","options":{"url":"https://{% global_resource qualys %}/api/2.0/fo/scan/","method":"post","payload":{"action":"fetch","scan_ref":"{{ .get_scan_reference.scan_ref }}","output_format":"json"},"basic_auth":["{% global_resource qualys_username %}","{% credential qualys_password %}"],"headers":{"X-Requested-With":"Tines"}},"schedule":null,"keep_events_for":0}],"links":[{"source":0,"receiver":1},{"source":1,"receiver":9},{"source":1,"receiver":10},{"source":2,"receiver":14},{"source":4,"receiver":7},{"source":5,"receiver":6},{"source":6,"receiver":0},{"source":7,"receiver":17},{"source":8,"receiver":1},{"source":9,"receiver":8},{"source":10,"receiver":15},{"source":11,"receiver":13},{"source":12,"receiver":17},{"source":14,"receiver":16},{"source":15,"receiver":3},{"source":16,"receiver":12},{"source":17,"receiver":4},{"source":17,"receiver":5},{"source":17,"receiver":11}],"diagram_layout":"{\"3a7edabe067d153141219d0f1fe082e5\":[0,600],\"43f342bc42c38a0d41c8ec80a3471302\":[0,750],\"eee391b7f123509604003f3410f6baab\":[0,1005],\"7d04c1cd4017cec66413145a427ba009\":[0,1095],\"f794e2da5764832644ab6dbc8335eb5a\":[-210,855],\"3727a6d978fa4a66acff969661f4da41\":[0,855],\"5045ec75742882c8efbd958a537aab9a\":[-210,915],\"5abf875016bf40171cf2dcd670a592b5\":[-210,1260],\"4502433a21f872e91b1d5eb1743f1f6f\":[-210,1200],\"2297441afb7180f22a6df284d7bcdb79\":[0,1200],\"85168d4d6e7d52e9afa8a55d41b5e936\":[0,1305],\"fa9d0097c76f978cac1ba1f20a5e987d\":[0,675],\"bcbe3e2321d94df8ce0e53ed99a78e84\":[0,540],\"b2f5f9309bc460449a165a93df0e9e06\":[0,465],\"6e466cc2684c24356b9fd54e19008c59\":[0,1380],\"851a703e6f307ad7faf50a7d7d2c4d29\":[0,915],\"4b4a243277aed38a6865e6aa812dcee7\":[210,855],\"a4703cebada7d89adc818ed8e67f4d20\":[210,930]}","send_to_story_enabled":null,"entry_agent_guid":null,"exit_agent_guid":null,"send_to_stories":[{"schema_version":3,"name":"STS Update Jira","description":null,"guid":"0d11e0cdacefe57fbbf822b0519aaa74","exported_at":"2020-10-01T11:36:44Z","agents":[{"type":"Agents::EventTransformationAgent","name":"Return Details","disabled":false,"guid":"78420229cc264c55b6372d757d3e218d","options":{"mode":"message_only","message":"This is an automatically generated message from Tines"},"keep_events_for":0},{"type":"Agents::WebhookAgent","name":"Webhook Agent","disabled":false,"guid":"b6f11fe3b9870aff85a278f12098109a","options":{"secret":"23fba38a1f4c4629935db1e85b168a26","verbs":"get,post"},"keep_events_for":0}],"links":[{"source":1,"receiver":0}],"diagram_layout":"{\"b6f11fe3b9870aff85a278f12098109a\":[-15,60],\"78420229cc264c55b6372d757d3e218d\":[-15,135]}","send_to_story_enabled":true,"entry_agent_guid":"b6f11fe3b9870aff85a278f12098109a","exit_agent_guid":"78420229cc264c55b6372d757d3e218d","form":{"name":"New story tines@defensible.ie Form","description":"","fields":[],"visibility":"tenant","agent_guid":null,"enabled":false,"success_message":"Thank you for your submission"}}],"form":{"name":"Self Serve Security Gating Form","description":"This is a self-scan request form. It will help you to pass the security gating part of your project, faster. By addressing security vulnerabilities earlier, you can go-live faster. You can use this as often as you want to ensure you have no high severity issues for your go-live review however you must provide the latest scan on the day of your review.","fields":[{"name":"IP Address or Multiple Addresses","description":"One or more IPs/ranges may be specified. Multiple IPs/ranges are comma separated. An IP range is specified with a hyphen (for example, 10.10.30.1-10.10.30.50). CIDR notation is supported.","required":true,"type":"LONG_TEXT","multi_select":false,"options":["Option 1","Option 2"],"ranking":1879048192,"max_characters":null},{"name":"Requester Email","description":"Project Manager or SME (Subject Matter Expert) owning the security of the project. Report is also sent to this email address.","required":true,"type":"EMAIL","multi_select":false,"options":["Option 1","Option 2"],"ranking":2080374784,"max_characters":null},{"name":"WBS Code","description":"Please use your WBS code to ensure faster and better outcomes with the Security team. If you don't have a WBS code please use a JIRA key or the Project Name *and* Department Name.","required":true,"type":"SHORT_TEXT","multi_select":false,"options":["Option 1","Option 2"],"ranking":2013265920,"max_characters":null}],"visibility":"tenant","agent_guid":"b2f5f9309bc460449a165a93df0e9e06","enabled":false,"success_message":"Submitted. Thank you \n\nPlease contact security@tines.io if you do not receive your scan within the hour \n(or if you have any questions relating to the process)."}}