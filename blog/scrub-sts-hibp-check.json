{"schema_version":1,"name":"Scrub STS HIBP Check","description":null,"guid":"0477fcc71d031aa5051b78b8b0dbb640","exported_at":"2020-07-31T09:06:27Z","agents":[{"type":"Agents::HTTPRequestAgent","name":"Search an Email in Have I Been Pwned","disabled":false,"guid":"ad6495a1d3891fffe4c65f505dcca055","options":{"url":"https://{% global_resource haveibeenpwnedhost %}/api/v3/breachedaccount/{{ .receive_webhook_with_email.email }}","content_type":"json","method":"get","headers":{"hibp-api-key":"{% credential haveibeenpwned %}","user-agent":"Tines Security Automation"}},"schedule":null,"keep_events_for":604800},{"type":"Agents::TriggerAgent","name":"Trigger if Any Breach Found","disabled":false,"guid":"dd4a761b89c68cd98b4fcbadc302020f","options":{"rules":[{"type":"field>value","value":"0","path":"{{ .search_an_email_in_have_i_been_pwned.body.size }}"}]},"keep_events_for":604800},{"type":"Agents::WebhookAgent","name":"Receive Webhook with Email","disabled":false,"guid":"5182e68ae0eaaed67da43de8bc6902bb","options":{"secret":"db2f9e8b5fa219a2cc483a973b3ff317","verbs":"get,post"},"keep_events_for":604800},{"type":"Agents::EventTransformationAgent","name":"Return Breach Information","disabled":false,"guid":"d8bda4a5b15e1afa81caa898d06caa3a","options":{"mode":"message_only","breach_found":"{{ .set_breach_status.breach_status }}","email":"{{ .receive_webhook_with_email.email }}","breach_names":"{{ .search_an_email_in_have_i_been_pwned.body | json_parse | as_object }}"},"keep_events_for":604800},{"type":"Agents::EventTransformationAgent","name":"Set breach_status","disabled":false,"guid":"a3f8da98d37b18a9c3bfb70e27e850ed","options":{"mode":"message_only","breach_status":"false"},"keep_events_for":604800},{"type":"Agents::TriggerAgent","name":"Trigger if Any No Breach Found","disabled":false,"guid":"c64ae4c12d7209c8ba57b75c5a4329b6","options":{"rules":[{"type":"field==value","value":"0","path":"{{ .search_an_email_in_have_i_been_pwned.body.size }}"}]},"keep_events_for":604800},{"type":"Agents::EventTransformationAgent","name":"Set breach_status","disabled":false,"guid":"925eb8d312f3bee31c1618111974180b","options":{"mode":"message_only","breach_status":"true"},"keep_events_for":604800},{"type":"Agents::SendToStoryAgent","name":"STS Test","disabled":false,"guid":"8d1e10e7c26084733f3ad7089fe1fd28","options":{"story":"{% story STS HIBP Check %}","payload":{"email":"donal@pansift.com"}},"schedule":null,"keep_events_for":604800},{"type":"Agents::EventTransformationAgent","name":"What is Webhook Agent_ID","disabled":false,"guid":"8d34e7c38d36f6cac017510ea3817177","options":{"mode":"message_only","agent_id":"{{ .receive_webhook_with_email.['#agent_id'] }}"},"keep_events_for":604800}],"links":[{"source":0,"receiver":5},{"source":0,"receiver":1},{"source":1,"receiver":6},{"source":2,"receiver":0},{"source":4,"receiver":3},{"source":5,"receiver":4},{"source":6,"receiver":3}],"diagram_layout":"{\"5182e68ae0eaaed67da43de8bc6902bb\":[-1125,345],\"ad6495a1d3891fffe4c65f505dcca055\":[-1125,435],\"dd4a761b89c68cd98b4fcbadc302020f\":[-1020,540],\"925eb8d312f3bee31c1618111974180b\":[-1020,615],\"c64ae4c12d7209c8ba57b75c5a4329b6\":[-1245,540],\"a3f8da98d37b18a9c3bfb70e27e850ed\":[-1245,615],\"d8bda4a5b15e1afa81caa898d06caa3a\":[-1110,705],\"8d34e7c38d36f6cac017510ea3817177\":[-180,495],\"8d1e10e7c26084733f3ad7089fe1fd28\":[-180,420]}","send_to_story_enabled":true,"entry_agent_guid":"5182e68ae0eaaed67da43de8bc6902bb","exit_agent_guid":"d8bda4a5b15e1afa81caa898d06caa3a","send_to_stories":[{"schema_version":1,"name":"STS HIBP Check","description":null,"guid":"f75537111500dc6d283a71e5bb650b4a","exported_at":"2020-07-31T09:06:27Z","agents":[{"type":"Agents::EventTransformationAgent","name":"What is Webhook Agent_ID","disabled":false,"guid":"8d34e7c38d36f6cac017510ea3817177","options":{"mode":"message_only","agent_id":"{{ .receive_webhook_with_email.['#agent_id'] }}"},"keep_events_for":0},{"type":"Agents::SendToStoryAgent","name":"STS Test","disabled":false,"guid":"8d1e10e7c26084733f3ad7089fe1fd28","options":{"story":"{% story STS HIBP Check %}","payload":{"email":"donal@pansift.com"}},"schedule":null,"keep_events_for":0},{"type":"Agents::EventTransformationAgent","name":"Set breach_status","disabled":false,"guid":"925eb8d312f3bee31c1618111974180b","options":{"mode":"message_only","breach_status":"true"},"keep_events_for":0},{"type":"Agents::TriggerAgent","name":"Trigger if Any No Breach Found","disabled":false,"guid":"c64ae4c12d7209c8ba57b75c5a4329b6","options":{"rules":[{"type":"field==value","value":"0","path":"{{ .search_an_email_in_have_i_been_pwned.body.size }}"}]},"keep_events_for":0},{"type":"Agents::EventTransformationAgent","name":"Set breach_status","disabled":false,"guid":"a3f8da98d37b18a9c3bfb70e27e850ed","options":{"mode":"message_only","breach_status":"false"},"keep_events_for":0},{"type":"Agents::EventTransformationAgent","name":"Return Breach Information","disabled":false,"guid":"d8bda4a5b15e1afa81caa898d06caa3a","options":{"mode":"message_only","breach_found":"{{ .set_breach_status.breach_status }}","email":"{{ .receive_webhook_with_email.email }}","breach_names":"{{ .search_an_email_in_have_i_been_pwned.body | json_parse | as_object }}"},"keep_events_for":0},{"type":"Agents::WebhookAgent","name":"Receive Webhook with Email","disabled":false,"guid":"5182e68ae0eaaed67da43de8bc6902bb","options":{"secret":"db2f9e8b5fa219a2cc483a973b3ff317","verbs":"get,post"},"keep_events_for":0},{"type":"Agents::TriggerAgent","name":"Trigger if Any Breach Found","disabled":false,"guid":"dd4a761b89c68cd98b4fcbadc302020f","options":{"rules":[{"type":"field>value","value":"0","path":"{{ .search_an_email_in_have_i_been_pwned.body.size }}"}]},"keep_events_for":0},{"type":"Agents::HTTPRequestAgent","name":"Search an Email in Have I Been Pwned","disabled":false,"guid":"ad6495a1d3891fffe4c65f505dcca055","options":{"url":"https://haveibeenpwned.com/api/v3/breachedaccount/{{ .receive_webhook_with_email.email }}","content_type":"json","method":"get","headers":{"hibp-api-key":"{% credential haveibeenpwned %}","user-agent":"Tines Security Automation"}},"schedule":null,"keep_events_for":0}],"links":[{"source":2,"receiver":5},{"source":3,"receiver":4},{"source":4,"receiver":5},{"source":6,"receiver":8},{"source":7,"receiver":2},{"source":8,"receiver":7},{"source":8,"receiver":3}],"diagram_layout":"{\"5182e68ae0eaaed67da43de8bc6902bb\":[-1125,345],\"ad6495a1d3891fffe4c65f505dcca055\":[-1125,435],\"dd4a761b89c68cd98b4fcbadc302020f\":[-1020,540],\"925eb8d312f3bee31c1618111974180b\":[-1020,615],\"c64ae4c12d7209c8ba57b75c5a4329b6\":[-1245,540],\"a3f8da98d37b18a9c3bfb70e27e850ed\":[-1245,615],\"d8bda4a5b15e1afa81caa898d06caa3a\":[-1110,705],\"8d34e7c38d36f6cac017510ea3817177\":[-180,495],\"8d1e10e7c26084733f3ad7089fe1fd28\":[-180,420]}","send_to_story_enabled":true,"entry_agent_guid":"5182e68ae0eaaed67da43de8bc6902bb","exit_agent_guid":"d8bda4a5b15e1afa81caa898d06caa3a"}]}